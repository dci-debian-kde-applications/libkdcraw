commit 3be5fad63bc9386f3378deb0c0e0e6bd12a56a93
Author: Maximiliano Curia <maxy@debian.org>
Date:   Thu Jun 20 12:06:48 2013 +0200

    CVE-2013-2126: double free, fix from: https://github.com/LibRaw/LibRaw/commit/c14ae36d28e80139b2f31b5d9d7623db3b597a3a

diff --git a/libraw/src/libraw_cxx.cpp b/libraw/src/libraw_cxx.cpp
index c2ad556..47ee7b1 100644
--- a/libraw/src/libraw_cxx.cpp
+++ b/libraw/src/libraw_cxx.cpp
@@ -792,8 +792,8 @@ int LibRaw::unpack(void)
                 S.iheight= S.height;
                 IO.shrink = 0;
                 // allocate image as temporary buffer, size 
-                imgdata.rawdata.raw_alloc = calloc(S.iwidth*S.iheight,sizeof(*imgdata.image));
-                imgdata.image = (ushort (*)[4]) imgdata.rawdata.raw_alloc;
+                imgdata.rawdata.raw_alloc = 0;
+                imgdata.image = (ushort (*)[4]) calloc(S.iwidth*S.iheight,sizeof(*imgdata.image));
             }
 
 
@@ -803,8 +803,8 @@ int LibRaw::unpack(void)
         // recover saved
         if( decoder_info.decoder_flags & LIBRAW_DECODER_LEGACY)
             {
-                imgdata.image = 0; 
-                imgdata.rawdata.color_image = (ushort (*)[4]) imgdata.rawdata.raw_alloc;
+              imgdata.rawdata.raw_alloc = imgdata.rawdata.color_image = imgdata.image;
+              imgdata.image = 0;
             }
 
         // calculate channel maximum
